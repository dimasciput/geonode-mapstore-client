(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[1701],{67007:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>D});var n=r(72500),o=r.n(n),a=r(1469),i=r.n(a),l=r(84596),s=r.n(l),c=r(27361),u=r.n(c),f=r(27418),p=r.n(f),y=r(5055),d=r.n(y),b=r(75875),m=r.n(b),v=r(37275),g=r(86267);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var w={},E=function(e){var t=(i()(e)&&e||e.split(","))[0],r=o().parse(t,!0);return o().format(p()({},r,{search:null},{query:p()({service:"WMS",version:"1.3.0",request:"GetCapabilities"},r.query)}))},j=function(e){var t=e&&e.Title,r=e.LogoURL&&O(O({},u()(e,"LogoURL.$")||{}),{},{format:u()(e,"LogoURL.Format")}),n=u()(e,'OnlineResource.$["xlink:href"]');return{title:t,logo:r,imageUrl:u()(e,'LogoURL.OnlineResource.$["xlink:href"]'),link:n}},P=function e(t){return t.Layer?(i()(t.Layer)&&t.Layer||[t.Layer]).reduce((function(t,r){return t.concat(e(r)).concat(r.Layer&&r.Name?[r]:[])}),[]):t.Name&&[t]||[]},x=function(e){return e.Request&&e.Request.GetMap&&e.Request.GetMap.DCPType&&e.Request.GetMap.DCPType.HTTP&&e.Request.GetMap.DCPType.HTTP.Get&&e.Request.GetMap.DCPType.HTTP.Get.OnlineResource&&e.Request.GetMap.DCPType.HTTP.Get.OnlineResource.$||void 0},N=function(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,s=(n.WMS_Capabilities||n.WMT_MS_Capabilities||{}).Capability,c=(n.WMS_Capabilities||n.WMT_MS_Capabilities||{}).Service,u=x(s),f=s.Layer&&(null===(e=s.Layer.SRS||s.Layer.CRS)||void 0===e?void 0:e.map((function(e){return e.toUpperCase()})))||[],y=s.Layer&&s.Layer.Attribution&&j(s.Layer.Attribution),d=s.Request&&s.Request.GetMap&&s.Request.GetMap.Format||[],b=P(s),m=i()(b)?b:[b],v=m.filter((function(e){return!l||-1!==e.Name.toLowerCase().indexOf(l.toLowerCase())||e.Title&&-1!==e.Title.toLowerCase().indexOf(l.toLowerCase())||e.Abstract&&-1!==e.Abstract.toLowerCase().indexOf(l.toLowerCase())}));return{numberOfRecordsMatched:v.length,numberOfRecordsReturned:Math.min(a,v.length),nextRecord:o+Math.min(a,v.length)+1,service:c,layerOptions:{version:(null===(t=n.WMS_Capabilities||n.WMT_MS_Capabilities)||void 0===t||null===(r=t.$)||void 0===r?void 0:r.version)||"1.3.0"},records:v.filter((function(e,t){return t>=o-1&&t<o-1+a})).map((function(e){return p()({},e,{formats:d,onlineResource:u,SRS:f,credits:e.Attribution?j(e.Attribution):y})}))}},T=function(e,t,r,n){var o=w[e];return o&&(new Date).getTime()<o.timestamp+1e3*((0,v.u8)("cacheExpire")||60)?new Promise((function(e){e(N(o.data,t,r,n))})):m().get(E(e)).then((function(o){var a;return d().parseString(o.data,{explicitArray:!1},(function(e,t){a=t})),w[e]={timestamp:(new Date).getTime(),data:a},N(a,t,r,n)}))};const D={flatLayers:P,parseUrl:E,getDimensions:function(e){return s()(e.Dimension||e.dimension||[]).map((function(t,r){var n=e.Extent&&s()(e.Extent)[r]||e.extent&&s()(e.extent)[r];return{name:t.$.name,units:t.$.units,unitSymbol:t.$.unitSymbol,default:t.$.default||n&&n.$.default,values:t._&&t.split(",")||n&&n._&&n.split(",")}}))},getCapabilities:function(e,t){var n=o().parse(e,!0),a=o().format(p()({},n,{query:p()({service:"WMS",version:"1.1.1",request:"GetCapabilities"},n.query)}));return new Promise((function(e){Promise.all([r.e(9942),r.e(7260)]).then(function(){var n=r(67260).unmarshaller;e(m().get(E(a)).then((function(e){var r;if(t)return d().parseString(e.data,{explicitArray:!1},(function(e,t){r=t})),r;var o=n.unmarshalString(e.data);return o&&o.value})))}.bind(null,r)).catch(r.oe)}))},describeLayer:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=o().parse(e,!0),i=o().format(p()({},a,{query:p()({service:"WMS",version:"1.1.1",layers:t,request:"DescribeLayer"},a.query,n.query||{})}));return new Promise((function(e){Promise.all([r.e(9942),r.e(7260)]).then(function(){var t=r(67260).unmarshaller;e(m().get(E(i)).then((function(e){var r=t.unmarshalString(e.data);return r&&r.value&&r.value.layerDescription&&r.value.layerDescription[0]})))}.bind(null,r)).catch(r.oe)}))},getRecords:T,describeLayers:function(e,t){var r=o().parse(e,!0),n=o().format(p()({},r,{query:p()({service:"WMS",version:"1.1.1",layers:t,request:"DescribeLayer"},r.query)}));return m().get(E(n)).then((function(e){var t;return d().parseString(e.data,{explicitArray:!1},(function(e,r){t=r&&r.WMS_DescribeLayerResponse&&r.WMS_DescribeLayerResponse.LayerDescription})),(t=Array.isArray(t)?t:[t]).map((function(e){return O(O({},e&&e.$||{}),{},{layerName:e&&e.$&&e.$.name,query:O({},e&&e.query&&e.query.$||{})})}))}))},textSearch:function(e,t,r,n){return T(e,t,r,n)},parseLayerCapabilities:function e(t,r,n){return s()(n||u()(t,"capability.layer.layer")).reduce((function(n,o){return n||(!o.name&&o.layer?e(t,r,s()(o.layer)):2===r.name.split(":").length&&o.name&&2===o.name.split(":").length?r.name===o.name&&o:o.name&&2===o.name.split(":").length?r.name===o.name.split(":")[1]&&o:2===r.name.split(":").length?r.name.split(":")[1]===o.name&&o:r.name===o.name&&o)}),null)},getBBox:function(e,t){for(var r=e,n=r.EX_GeographicBoundingBox||r.exGeographicBoundingBox||(0,g.getWMSBoundingBox)(r.BoundingBox)||r.LatLonBoundingBox&&r.LatLonBoundingBox.$||r.latLonBoundingBox;!n&&r.Layer&&r.Layer.length;)n=(r=r.Layer[0]).EX_GeographicBoundingBox||r.exGeographicBoundingBox||(0,g.getWMSBoundingBox)(r.BoundingBox)||r.LatLonBoundingBox&&r.LatLonBoundingBox.$||r.latLonBoundingBox;n||(n={westBoundLongitude:-180,southBoundLatitude:-90,eastBoundLongitude:180,northBoundLatitude:90});var o={extent:[n.westBoundLongitude||n.minx,n.southBoundLatitude||n.miny,n.eastBoundLongitude||n.maxx,n.northBoundLatitude||n.maxy],crs:"EPSG:4326"};return t?{crs:o.crs,bounds:{minx:o.extent[0],miny:o.extent[1],maxx:o.extent[2],maxy:o.extent[3]}}:o},reset:function(){Object.keys(w).forEach((function(e){delete w[e]}))}}},75480:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(24852),o=r.n(n);const a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.style,r=void 0===t?{display:"inline-block"}:t;return o().createElement("div",{style:r,className:"mapstore-inline-loader"})}},76424:(e,t,r)=>{"use strict";r.d(t,{Z:()=>y});var n=r(24852),o=r.n(n),a=r(13218),i=r.n(a),l=r(32425),s=["body","caption","infoExtra","className","description","fullText","onClick","onMouseEnter","onMouseLeave","preview","selected","size","style","stylePreview","styleTools","title","loading","dragSymbol","tools"];function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}const y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.body,r=e.caption,n=e.infoExtra,a=e.className,c=void 0===a?"":a,f=e.description,y=e.fullText,d=e.onClick,b=void 0===d?function(){}:d,m=e.onMouseEnter,v=void 0===m?function(){}:m,g=e.onMouseLeave,h=void 0===g?function(){}:g,O=e.preview,S=e.selected,w=e.size,E=e.style,j=void 0===E?{}:E,P=e.stylePreview,x=void 0===P?{}:P,N=e.styleTools,T=void 0===N?{}:N,D=e.title,L=e.loading,M=e.dragSymbol,k=void 0===M?"+":M,C=e.tools,R=p(e,s);return o().createElement("div",{className:"mapstore-side-card".concat(S?" selected":"").concat(w?" ms-"+w:"").concat(c?" ".concat(c):"").concat(y?" full-text":""),onClick:function(e){return b(u({title:D,preview:O,description:f,caption:r,tools:C},R),e)},onMouseEnter:v,onMouseLeave:h,style:j},o().createElement("div",{className:"ms-head"},R.isDraggable&&R.connectDragSource&&R.connectDragSource(o().createElement("div",{className:"mapstore-side-card-tool text-center"},o().createElement("div",{style:{width:10,overflow:"hidden"}},k))),O&&o().createElement("div",{className:"mapstore-side-preview",style:x},O),o().createElement("div",{className:"mapstore-side-card-container"},o().createElement("div",{className:"mapstore-side-card-inner"},o().createElement("div",{className:"mapstore-side-card-left-container"},o().createElement("div",{className:"mapstore-side-card-info"},D&&o().createElement("div",{className:"mapstore-side-card-title"},o().createElement("span",null,D)),f&&o().createElement("div",{className:"mapstore-side-card-desc"},i()(f)?f:o().createElement("span",null,f)),r&&o().createElement("div",{className:"mapstore-side-card-caption"},o().createElement("span",null,r))),n),o().createElement("div",{className:"mapstore-side-card-right-container"},o().createElement("div",{className:"mapstore-side-card-tool text-center",style:T},C),"sm"!==w&&o().createElement("div",{className:"mapstore-side-card-loading"},o().createElement(l.Z,{className:"mapstore-side-card-loader",size:12,hidden:!L})))))),t&&o().createElement("div",{className:"ms-body"},t))}},12346:(e,t,r)=>{"use strict";r.d(t,{Z:()=>C});var n=r(24852),o=r.n(n),a=r(45697),i=r.n(a),l=r(30294),s=r(45869),c=r(80717),u=r(5346);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function b(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(l,e);var t,r,n,a,i=(n=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(n);if(a){var r=m(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return b(this,e)});function l(){return p(this,l),i.apply(this,arguments)}return t=l,(r=[{key:"render",value:function(){var e=this;return o().createElement(c.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},btnGroupProps:{style:{margin:10}},buttons:[{glyph:this.props.checked?"chevron-down":"chevron-left",visible:!0,tooltip:this.props.checked?o().createElement(u.Z,{msgId:"collapse"}):o().createElement(u.Z,{msgId:"expand"}),onClick:function(){return e.props.onClick(!e.props.checked)}}]})}}])&&y(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(o().Component);v(g,"propTypes",{checked:i().bool,onClick:i().func}),v(g,"defaultProps",{checked:!1,onClick:function(){}});const h=g;var O=r(38560),S=r(82110);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function P(e,t){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},P(e,t)}function x(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return N(e)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},T(e)}function D(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var L=function(){return o().createElement(O.Z,{className:"square-button-sm no-border switch-error"},o().createElement(l.Glyphicon,{glyph:"exclamation-mark",className:"text-danger"}))},M=function(){return o().createElement("div",{className:"switch-loading"},o().createElement(S.Z,{size:"small"}))},k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}(u,e);var t,r,n,a,i=(n=u,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=T(n);if(a){var r=T(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return x(this,e)});function u(){var e;E(this,u);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return D(N(e=i.call.apply(i,[this].concat(r))),"state",{}),e}return t=u,(r=[{key:"renderHeader",value:function(){var e=this,t=this.props.useToolbar?h:s.Z;return o().createElement("div",null,o().createElement("div",{className:"pull-left"},this.props.title||this.props.header),o().createElement("div",{className:"pull-right"},this.props.locked?null:o().createElement(t,{checked:this.props.expanded,onClick:function(t){e.props.onSwitch(t)}}),this.props.error?o().createElement(L,null):null,this.props.loading?o().createElement(M,null):null,this.props.buttons.length>0&&this.props.expanded&&o().createElement(c.Z,{btnDefaultProps:{className:"square-button-sm no-border"},buttons:this.props.buttons})))}},{key:"render",value:function(){return o().createElement(l.Panel,{className:"mapstore-switch-panel",collapsible:!0,expanded:this.props.expanded,defaultExpanded:this.props.defaultExpanded,header:this.renderHeader()},this.props.children)}}])&&j(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(o().Component);D(k,"propTypes",{header:i().node,title:i().oneOfType([i().string,i().node]),defaultExpanded:i().string,expanded:i().bool,onSwitch:i().func,locked:i().bool,buttons:i().array,loading:i().bool,error:i().any,errorMsgId:i().string,transitionProps:i().object,useToolbar:i().bool}),D(k,"defaultProps",{title:"",expanded:!1,onSwitch:function(){},locked:!1,buttons:[],useToolbar:!1});const C=k},94943:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>Y});var n=r(49977),o=r.n(n),a=r(27361),i=r.n(a),l=r(91175),s=r.n(l),c=r(1469),u=r.n(c),f=r(41106),p=r.n(f),y=r(19155),d=r.n(y),b=r(97395),m=r(80416),v=r(60604),g=r(90825),h=r(80833),O=r(82904),S=r(24262),w=r(96909),E=r(9082),j=r(75875),P=r.n(j),x=r(84596),N=r.n(x),T=r(99009);function D(e){return function(e){if(Array.isArray(e))return L(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return L(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach((function(t){C(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const R=function(e,t,r){var n=e+"layers/"+t+".json";return P().get(n,r).then((function(e){return e.data&&e.data.layer}))},B=function(e){var t=e.baseUrl,r=e.layerName,n=e.styles,o=void 0===n?[]:n,a=e.options,i=void 0===a?{}:a,l=(0,T.$N)(r),s=l.name,c=l.workspace,u="".concat(t,"rest/").concat(c&&"workspaces/".concat(c,"/")||"","layers/").concat(s,".json");return P().get(u,i).then((function(e){var t=e.data.layer||{},r=t.styles&&t.styles.style&&N()(t.styles.style)||[],n=o.map((function(e){return e.name})),a=r.filter((function(e){var t=e.name;return-1===n.indexOf(t)}));return{layer:k(k({},t),{},{styles:{"@class":"linked-hash-set",style:a}})}})).then((function(e){return P().put(u,e).then((function(){return e}))}))},U=function(e){var t=e.baseUrl,r=e.layerName,n=e.styles,o=void 0===n?[]:n,a=e.options,i=void 0===a?{}:a,l=(0,T.$N)(r),s=l.name,c=l.workspace,u="".concat(t,"rest/").concat(c&&"workspaces/".concat(c,"/")||"","layers/").concat(s,".json");return P().get(u,i).then((function(e){var t=e.data.layer||{},r=t.styles&&t.styles.style&&N()(t.styles.style)||[];return{layer:k(k({},t),{},{styles:{"@class":"linked-hash-set",style:[].concat(D(r),D(o))}})}})).then((function(e){return P().put(u,e).then((function(){return e}))}))},_=function(e){var t=e.baseUrl,r=e.layerName,n=e.styleName,o=e.options,a=void 0===o?{}:o,i=(0,T.$N)(r),l=i.name,s=i.workspace,c="".concat(t,"rest/").concat(s&&"workspaces/".concat(s,"/")||"","layers/").concat(l,".json");return P().get(c,a).then((function(e){var t=e.data.layer||{},r=t.styles&&t.styles.style&&N()(t.styles.style)||[],o=t.defaultStyle||{},a=d()([o].concat(D(r)),"name");return{layer:k(k({},t),{},{defaultStyle:{name:n},styles:{"@class":"linked-hash-set",style:a}})}})).then((function(e){return P().put(c,e).then((function(){return e}))}))};var W=r(93222),A=r(75110),I=r(7147),Z=r(8954),$=["name","workspace"];function q(e){return function(e){if(Array.isArray(e))return F(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||V(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){if(e){if("string"==typeof e)return F(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?F(e,t):void 0}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var H=function(e){var t=e.status,r=e.styleName,n=e.baseUrl;return"edit"===t?o().Observable.defer((function(){return E.ZP.getStyleCodeByName({baseUrl:n,styleName:r})})).switchMap((function(e){return o().Observable.of((0,w.FU)({languageVersion:e.languageVersion,code:e.code,templateId:"",format:e.format,init:!0}))})).catch((function(e){return o().Observable.of((0,w.Fe)("edit",e))})):o().Observable.empty()},J=function(e){var t=e.styleName,r=e.baseUrl,n=e.onSuccess$,a=e.onError$;return o().Observable.defer((function(){return E.ZP.deleteStyle({baseUrl:r,styleName:t})})).switchMap((function(){return n||o().Observable.empty()})).catch((function(){return a||o().Observable.empty()}))},K=function(e){var t=e.baseUrl,r=e.update,n=e.code,a=e.format,i=e.styleName,l=e.status,s=e.languageVersion,c=e.options,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return o().Observable.defer((function(){return E.ZP[r?"updateStyle":"createStyle"]({baseUrl:t,code:n,format:a,styleName:i,languageVersion:s,options:c})})).switchMap((function(){var e;return u()(f)&&(e=o().Observable).of.apply(e,[(0,w.Wm)()].concat(q(f)))||f})).catch((function(e){var t;return(t=o().Observable).of.apply(t,[(0,w.Fe)(l,e),(0,w.Wm)()].concat(q(p)))})).startWith((0,w.pt)(l))};function Q(e,t){return!t&&e.availableStyles?o().Observable.of((0,m.Xy)({availableStyles:e.availableStyles}),(0,w.Wm)()):(0,h.kB)(e).switchMap((function(t){var r=(0,S.IA)(t);return r.availableStyles?o().Observable.of((0,m.Xy)({availableStyles:r.availableStyles}),(0,m.tV)(e.id,"layer",X({},r)),(0,w.Wm)()):o().Observable.of((0,w.Fe)("availableStyles",{status:401}),(0,w.Wm)())})).catch((function(e){var t=-1!==e.message.indexOf("could not be unmarshalled")?"parsingCapabilities":"global";return o().Observable.of((0,w.Fe)(t,e),(0,w.Wm)())})).startWith((0,w.pt)("global"))}const Y={toggleStyleEditorEpic:function(e,t){return e.ofType(w.vZ).filter((function(){return!(0,W.aN)(t.getState())})).switchMap((function(e){var r=t.getState(),n=(0,A.jN)(r),a=!!i()(n,"options.availableStyles");if(!e.enabled)return function(e){var t=(0,W.gc)(e),r=(0,W.Z0)(e).baseUrl,n=void 0===r?"":r;return o().Observable.of((0,w.l1)(),(0,v.fU)({owner:T.s1})).merge(t?J({styleName:t,baseUrl:n}):o().Observable.empty())}(r);if((0,W.ji)(r)&&a)return o().Observable.empty();var l=e.layer||(0,A.Iz)(r);if(!l||l&&!l.url)return o().Observable.empty();var s=(0,S.Nd)(l);if(!s)return Q(l);var c=l.url.split(s),u="".concat(c[0]).concat(s),f=(0,W.Z0)(r);return o().Observable.concat(o().Observable.of((0,w.pt)("global"),(0,w.l1)()),o().Observable.defer((function(){return(0,Z.eb)({baseUrl:u,styleService:f})})).switchMap((function(e){return o().Observable.concat(o().Observable.of((0,w.E0)(e)),o().Observable.defer((function(){return R(u+"rest/",l.name)})).switchMap((function(e){var t,r=(null==e||null===(t=e.styles)||void 0===t?void 0:t.style)||[],n=d()([e.defaultStyle].concat(q(r)),"name");return 0===n.length?o().Observable.of((0,w.Fe)("availableStyles",{status:401}),(0,w.Wm)()):o().Observable.defer((function(){return Promise.all([E.ZP.getStylesInfo({baseUrl:u,styles:n}),(0,h.kB)(l).toPromise().then((function(e){return e})).catch((function(){return null}))])})).switchMap((function(e){var t,r,n=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,l=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(l)throw o}}return a}}(t,r)||V(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=n[0],i=n[1],s=i&&(0,S.IA)(i),c=((null==s?void 0:s.availableStyles)||[]).map((function(e){return X(X({},e),(0,T.$N)(e.name))})).filter((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name;return t})),u=c.length>0?a.map((function(e){var t=(0,T.$N)(e.name),r=c.find((function(e){return e.name===t.name}))||{},n=(r.name,r.workspace,function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(r,$));return n?X(X({},n),e):e})):a;return o().Observable.of((0,v.W)(l.id,T.s1,"override",{}),(0,m.Xy)({availableStyles:u}),(0,m.tV)(l.id,"layer",{availableStyles:u}),(0,w.Wm)())}))})).catch((function(){return Q(l,!0)})))})))}))},updateLayerOnStatusChangeEpic:function(e,t){return e.ofType(w.g$).filter((function(e){return!!e.status})).switchMap((function(r){var n=t.getState(),a=(0,W.Vf)(n),i=a&&a.params||{},l=a&&!a.describeFeatureType&&(0,g.H)(a.url,a,{query:i}),s=(0,W.i7)(n)||a.availableStyles&&a.availableStyles[0]&&a.availableStyles[0].name,c=(0,W.Ri)(n),u=(0,W.Z0)(n).baseUrl,f=void 0===u?"":u;return l&&function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};return(r=o().Observable).of.apply(r,[(0,w.pt)("global")].concat(q(a))).merge(e.ofType(m.K$).filter((function(){var e=(0,A.Iz)(t.getState());return n(e)})).switchMap((function(){var e=(0,A.Iz)(t.getState());return i(e)})).catch((function(e){return o().Observable.of((0,w.Fe)("global",e),(0,w.Wm)())})).takeUntil(e.ofType(w.E2)))}(e,t,(function(e){return e&&e.describeLayer}),[l],(function(e){return o().Observable.concat(H({status:r.status,styleName:s,baseUrl:f}),o().Observable.of((0,w.xR)(!(e&&e.describeLayer&&401===e.describeLayer.error)),(0,w.bB)({editorType:c.msEditorType||"textarea",styleJSON:c.msStyleJSON}),(0,w.Wm)()))}))||o().Observable.concat(H({status:r.status,styleName:s,baseUrl:f}),o().Observable.of((0,w.bB)({editorType:c.msEditorType||"textarea",styleJSON:c.msStyleJSON})))}))},updateTemporaryStyleEpic:function(e,t){return e.ofType(w.TB,w.DX).switchMap((function(e){var r=t.getState(),n=(0,W.gc)(r),o=(0,W.Vf)(r),a=(0,T.$N)(o.name).workspace,i=e.format&&e.format!==(0,W.iB)(r),l=n||"".concat(a?"".concat(a,":"):"").concat((0,T.Vi)()),s=e.format||(0,W.iB)(r),c=(0,W.ex)(r),u=(0,W.Z0)(r).baseUrl,f=void 0===u?"":u,p=(0,W.j5)(r),y="sld"===s&&(e.code||"").match(/version=\"1\.1\.0\"/)&&{version:"1.1.0"}||e.format&&!e.languageVersion&&{version:"1.0.0"}||e.languageVersion||{version:"1.0.0"},d=p.version!==y.version?{params:{raw:!0}}:{},m=y,g=function(t){return K({update:!0,code:e.code,format:s,styleName:t,status:c,baseUrl:f,languageVersion:m,options:d},[(0,v.B1)(T.s1,[{style:t,_v_:Date.now(),singleTile:!0}]),(0,w.k5)({temporaryId:t,templateId:e.templateId||"",code:e.code,format:s,init:e.init,languageVersion:m})],"edit"===c?[]:[(0,b.vU)({title:"styleeditor.updateTmpErrorTitle",message:"styleeditor.updateTmpStyleErrorMessage",uid:"updateTmpStyleError",autoDismiss:5})])},h=("css"===s?"* { stroke: #888888; }":"sld"===s&&'<?xml version="1.0" encoding="ISO-8859-1"?>\n<StyledLayerDescriptor version="1.0.0"\n\t\txsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"\n\t\txmlns="http://www.opengis.net/sld"\n\t\txmlns:ogc="http://www.opengis.net/ogc"\n\t\txmlns:xlink="http://www.w3.org/1999/xlink"\n\t\txmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n\n\t<NamedLayer>\n\t\t<Name>Default Style</Name>\n\t\t<UserStyle>\n\t\t\t<Title>${styleTitle}</Title>\n\t\t\t<Abstract>${styleAbstract}</Abstract>\n\t\t\t<FeatureTypeStyle>\n\t\t\t\t<Rule>\n\t\t\t\t\t<Name>Rule Name</Name>\n\t\t\t\t\t<Title>Rule Title</Title>\n\t\t\t\t\t<Abstract>Rule Abstract</Abstract>\n\t\t\t\t\t<LineSymbolizer>\n\t\t\t\t\t\t<Stroke>\n\t\t\t\t\t\t\t<CssParameter name="stroke">#0000FF</CssParameter>\n\t\t\t\t\t\t</Stroke>\n\t\t\t\t\t\t</LineSymbolizer>\n\t\t\t\t\t<PointSymbolizer>\n\t\t\t\t\t\t<Graphic>\n\t\t\t\t\t\t\t<Mark>\n\t\t\t\t\t\t\t\t<WellKnownName>square</WellKnownName>\n\t\t\t\t\t\t\t\t<Fill>\n\t\t\t\t\t\t\t\t\t<CssParameter name="fill">#FF0000</CssParameter>\n\t\t\t\t\t\t\t\t</Fill>\n\t\t\t\t\t\t\t</Mark>\n\t\t\t\t\t\t</Graphic>\n\t\t\t\t\t</PointSymbolizer>\n\t\t\t\t\t</Rule>\n\t\t\t\t</FeatureTypeStyle>\n\t\t\t</UserStyle>\n\t\t</NamedLayer>\n\t</StyledLayerDescriptor>\n')||"",O=function(e){return K({code:h,format:s,styleName:e,status:c,baseUrl:f},g(e),[(0,b.vU)({title:"styleeditor.createTmpErrorTitle",message:"styleeditor.createTmpStyleErrorMessage",uid:"createTmpStyleError",autoDismiss:5}),(0,w.k5)({temporaryId:null,templateId:"",code:"",format:"",init:"",languageVersion:null})])};return i&&n&&J({styleName:n,baseUrl:f,onSuccess$:O("".concat(a?"".concat(a,":"):"").concat((0,T.Vi)())),onError$:g(l)})||n&&g(l)||O(l)}))},createStyleEpic:function(e,t){return e.ofType(w.vA).switchMap((function(e){var r=t.getState(),n=(0,W.gB)(r),a=(0,W.Vf)(r),i=(0,T.$N)(a.name).workspace,l="".concat(i?"".concat(i,":"):"").concat((0,T.nK)(e.settings)),c=(0,W.iB)(r),u=e.settings||{},f=u.title,y=void 0===f?"":f,d=u._abstract,g=void 0===d?"":d,h=(0,W.Z0)(r).baseUrl,O=void 0===h?"":h,S=X({title:y,description:g},{msStyleJSON:null,msEditorType:"visual"});return o().Observable.defer((function(){return E.ZP.createStyle({baseUrl:O,code:p()(n)({styleTitle:y,styleAbstract:g}),format:c,styleName:l,metadata:S})})).switchMap((function(){return o().Observable.of((0,v.B1)(T.s1,[{}]),(0,m.Xy)({style:l||""},!0),(0,w.Nf)(""),(0,w.Wm)()).merge(function(e){var t=e.baseUrl,r=e.layer,n=e.styleName,a=e.format,i=e.title,l=e._abstract,c=e.metadata;return o().Observable.defer((function(){return U({baseUrl:t,layerName:r.name,styles:[{name:n}]})})).switchMap((function(){var e=X({filename:"".concat(n,".").concat(a),format:a,name:n,title:i,_abstract:l},c&&{metadata:c}),t=s()(r.availableStyles),u=r.availableStyles&&[t,e].concat(q(r.availableStyles.filter((function(e,t){return t>0}))))||[e];return o().Observable.of((0,m.Xy)({availableStyles:u},!0),(0,w.Wm)())})).catch((function(){return o().Observable.of((0,w.Wm)())})).startWith((0,w.pt)("global"))}({layer:a,styleName:l,format:c,title:y,_abstract:g,baseUrl:O,metadata:S}))})).catch((function(e){return o().Observable.of((0,w.Fe)("",e),(0,w.Wm)(),(0,b.vU)({title:"styleeditor.createStyleErrorTitle",message:"styleeditor.createStyleErrorMessage",uid:"createStyleError",autoDismiss:5}))})).startWith((0,w.pt)(""))}))},updateStyleCodeEpic:function(e,t){return e.ofType(w.ch).switchMap((function(){var e=t.getState(),r=(0,W.iB)(e),n=(0,W.j5)(e),a=(0,W.gB)(e),i=(0,W.i7)(e),l=(0,W.gc)(e),s=(0,W.Vf)(e),c=(0,W.Z0)(e).baseUrl,u=void 0===c?"":c,f=(0,W.WW)(e)||{},p={msStyleJSON:f.styleJSON||null,msEditorType:f.editorType},y=(s.availableStyles||[]).map((function(e){return e.name===i?X(X({},e),{},{metadata:X(X({},e.metadata),p)}):e}));return o().Observable.defer((function(){return E.ZP.updateStyle({baseUrl:u,code:a,format:r,styleName:i,languageVersion:n,options:{params:{raw:!0}},metadata:p})})).switchMap((function(){return o().Observable.of((0,w.Wm)(),(0,m.tV)(s.id,"layer",{_v_:Date.now(),availableStyles:y}),(0,m.Xy)({availableStyles:y}),(0,w.k5)({temporaryId:l,templateId:"",code:a,format:r,init:!0,languageVersion:n}),(0,b.Vp)({title:"styleeditor.savedStyleTitle",message:"styleeditor.savedStyleMessage",uid:"savedStyleTitle",autoDismiss:5}))})).catch((function(e){return o().Observable.of((0,w.Fe)("global",e),(0,w.Wm)(),(0,b.vU)({title:"styleeditor.updateStyleErrorTitle",message:"styleeditor.updateStyleErrorMessage",uid:"updateStyleError",autoDismiss:5}))})).startWith((0,w.pt)("global"))}))},deleteStyleEpic:function(e,t){return e.ofType(w.j1).filter((function(e){return!!e.styleName})).switchMap((function(e){var r=e.styleName,n=t.getState(),a=(0,W.Vf)(n),i=(0,W.Z0)(n).baseUrl,l=void 0===i?"":i,s=(0,I.tL)(n),c=(0,I.Gd)(n);return o().Observable.defer((function(){return B({baseUrl:l,layerName:a.name,styles:[{name:r}]})})).switchMap((function(){var e=a.availableStyles&&a.availableStyles.filter((function(e){return e.name!==r}))||[];return o().Observable.concat(o().Observable.of((0,m.Xy)({style:"",availableStyles:e},!0),(0,w.Wm)(),(0,O.Xg)("layersettings","originalSettings",X(X({},s),{},{style:""})),(0,O.Xg)("layersettings","initialSettings",X(X({},c),{},{style:""}))),J({styleName:r,baseUrl:l,onSuccess$:o().Observable.of((0,b.Vp)({title:"styleeditor.deletedStyleSuccessTitle",message:"styleeditor.deletedStyleSuccessMessage",uid:"deletedStyleSuccess",autoDismiss:5})),onError$:o().Observable.of((0,b.vU)({title:"styleeditor.deletedStyleErrorTitle",message:"styleeditor.deletedStyleErrorMessage",uid:"deletedStyleError",autoDismiss:5}))}))})).catch((function(){return o().Observable.of((0,w.Wm)())})).startWith((function(){return o().Observable.of((0,w.pt)("global"))}))}))},setDefaultStyleEpic:function(e,t){return e.ofType(w.rb).switchMap((function(){var e=t.getState(),r=(0,W.Z0)(e).baseUrl,n=void 0===r?"":r,a=(0,W.Vf)(e),i=(0,W.i7)(e);return o().Observable.defer((function(){return _({baseUrl:n,layerName:a.name,styleName:i})})).switchMap((function(){var e=a.availableStyles.filter((function(e){var t=e.name;return i===t})),t=a.availableStyles.filter((function(e){var t=e.name;return i!==t})),r=[].concat(q(e),q(t));return o().Observable.of((0,m.Xy)({availableStyles:r},!0),(0,b.Vp)({title:"styleeditor.setDefaultStyleSuccessTitle",message:"styleeditor.setDefaultStyleSuccessMessage",uid:"setDefaultStyleSuccess",autoDismiss:5}),(0,w.Wm)())})).startWith((0,w.pt)("global")).catch((function(){return o().Observable.of((0,b.vU)({title:"styleeditor.setDefaultStyleErrorTitle",message:"styleeditor.setDefaultStyleErrorMessage",uid:"setDefaultStyleError",autoDismiss:5}),(0,w.Wm)())}))}))}}},80833:(e,t,r)=>{"use strict";r.d(t,{kB:()=>m,HI:()=>v});var n=r(72500),o=r.n(n),a=(r(91175),r(90173)),i=r(49977),l=r(67007),s=r(75875),c=r.n(s),u=(r(86267),r(24262)),f=r(10284),p=r(33044);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}a.default;var m=function(e){return i.Observable.defer((function(){return l.ZP.getCapabilities((0,u.Fh)(e))})).let(f.oB).map((function(t){return l.ZP.parseLayerCapabilities(t,e)}))},v=function(e){return function(e){return i.Observable.defer((function(){return c().get(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=e.search,n=void 0===r?{}:r,a=e.url,i=o().parse(n.url||a,!0);return o().format(d(d({},i),{},{search:void 0,query:d(d({},i.query),{},{service:"WMS",version:"1.1.1",layers:t,outputFormat:"application/json",request:"DescribeLayer"})}))}(e))})).let(f.oB)}(e).map((function(e){var t=e.data,r=void 0===t?{}:t;return r&&r.layerDescriptions[0]})).map((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.owsURL;return d(d({},e),{},{params:{},search:r?{type:"wfs",url:(0,p.cleanAuthParamsFromURL)(r)}:void 0})}))}},98592:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>W});var n=r(1469),o=r.n(n),a=r(47037),i=r.n(a),l=r(27418),s=r.n(l),c=r(45697),u=r.n(c),f=r(24852),p=r.n(f),y=r(71703),d=r(67076),b=r(22222),m=r(80416),v=r(96909),g=r(15402),h=r(65539),O=r(82030),S=r(73014),w=r(32425),E=r(74621),j=r(93222),P=r(99009),x=r(63977);function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){B(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e,t){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},k(e,t)}function C(e,t){if(t&&("object"===N(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}function B(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}(s,e);var t,r,n,a,l=(n=s,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=R(n);if(a){var r=R(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return C(this,e)});function s(){return L(this,s),l.apply(this,arguments)}return t=s,(r=[{key:"UNSAFE_componentWillMount",value:function(){var e=!this.props.editingAllowedRoles||o()(this.props.editingAllowedRoles)&&i()(this.props.userRole)&&-1!==this.props.editingAllowedRoles.indexOf(this.props.userRole);this.props.onInit(this.props.styleService,e&&(0,P.uW)(this.props.layer,this.props.styleService))}},{key:"render",value:function(){return p().createElement(h.Z,{className:"ms-style-editor-container",header:this.props.showToolbar?p().createElement("div",{className:"ms-style-editor-container-header"},this.props.header,p().createElement("div",{className:"text-center"},p().createElement(x.lC,{enableSetDefaultStyle:this.props.enableSetDefaultStyle}))):null,footer:p().createElement("div",{style:{height:25}})},this.props.isEditing?p().createElement(x.m2,{config:this.props.editorConfig}):p().createElement(x.tM,{showDefaultStyleIcon:this.props.canEdit&&this.props.enableSetDefaultStyle}))}}])&&M(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(p().Component);B(U,"propTypes",{layer:u().object,header:u().node,isEditing:u().bool,showToolbar:u().node.bool,onInit:u().func,styleService:u().object,userRole:u().string,editingAllowedRoles:u().array,enableSetDefaultStyle:u().bool,canEdit:u().bool,editorConfig:u().object}),B(U,"defaultProps",{layer:{},onInit:function(){},editingAllowedRoles:["ADMIN"],editorConfig:{}});var _=(0,d.compose)(d.toClass,(0,d.branch)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.active;return!t}),(function(){return function(){return null}})),(0,y.connect)((0,b.P1)([j.ex,j.aN,j.Vf,j.p,E.L3,j.z_,j.Z0],(function(e,t,r,n,o,a,i){return{isEditing:"edit"===e,loading:t,layer:r,error:n,userRole:o,canEdit:a,styleService:i}})),{onInit:v.E0,onUpdateParams:m.Xy},(function(e,t,r){var n,o,a,i=(null===(n=r.styleService)||void 0===n?void 0:n.baseUrl)===(null===(o=e.styleService)||void 0===o?void 0:o.baseUrl)&&(null===(a=e.styleService)||void 0===a?void 0:a.isStatic),l=r.styleService&&!i?D(D({},r.styleService),{},{isStatic:!0}):D({},e.styleService);return D(D(D(D({},r),e),t),{},{styleService:l})})),(0,O.Z)((function(e){var t=e.error;return!!(null!=t&&t.availableStyles||null!=t&&t.global||null!=t&&t.parsingCapabilities)}),(function(e){var t=e.error;return{glyph:"exclamation-mark",title:p().createElement(g.Z,{msgId:"styleeditor.errorTitle"}),description:p().createElement(g.Z,{msgId:((null==t?void 0:t.availableStyles)?"styleeditor.missingAvailableStylesMessage":(null==t?void 0:t.parsingCapabilities)&&"styleeditor.parsingCapabilitiesError")||(null==t?void 0:t.global)&&"styleeditor.globalError"}),style:{display:"flex",width:"100%",height:"100%",overflow:"hidden"},mainViewStyle:{margin:"auto",width:300}}})),(0,S.Z)((function(e){return"global"===e.loading}),{size:150,style:{margin:"auto"}},(function(e){return p().createElement("div",{style:{position:"relative",height:"100%",display:"flex"}},p().createElement(w.Z,e))})),(0,d.compose)((0,y.connect)((function(){return{}}),{toggleStyleEditor:v.Wv}),(0,d.lifecycle)({componentDidMount:function(){this.props.toggleStyleEditor(null,!0)}})))(U);const W={StyleEditorPlugin:s()(_,{TOC:{priority:1,container:"TOCItemSettings"},TOCItemsSettings:{name:"StyleEditor",target:"style",priority:1,ToolbarComponent:x.lC}}),reducers:{styleeditor:r(32244).Z},epics:r(94943).ZP}},32244:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(96909),o=r(47037),a=r.n(o);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.wL:return l(l({},e),{},{service:t.service,canEdit:t.canEdit});case n.Nm:return l(l({},e),{},{canEdit:t.canEdit});case n.gF:return l(l({},e),{},{temporaryId:t.temporaryId,templateId:t.templateId,code:t.code,format:t.format,error:null,languageVersion:t.languageVersion,initialCode:t.init?t.code:e.initialCode});case n.g$:return""===t.status?l(l({},e),{},{status:t.status,code:"",templateId:"",initialCode:"",addStyle:!1,error:{}}):l(l({},e),{},{status:t.status});case n.dJ:return{service:e.service&&l({},e.service)||{},canEdit:e.canEdit,loading:e.loading};case n.uz:return l(l({},e),{},{addStyle:t.add});case n.lX:return l(l({},e),{},{loading:!t.status||t.status});case n.E2:return l(l({},e),{},{loading:!1,enabled:!0});case n.mF:var r,o,i,c=(null==t||null===(r=t.error)||void 0===r?void 0:r.statusText)||(null==t||null===(o=t.error)||void 0===o?void 0:o.message)||"",u=a()(null==t||null===(i=t.error)||void 0===i?void 0:i.messageId)&&{messageId:t.error.messageId},f=c.match(/line\s([\d]+)|column\s([\d]+)|lineNumber:\s([\d]+)|columnNumber:\s([\d]+)/g),p=f&&2===f.length&&f.reduce((function(e,t){var r=t.split(" "),n=r[0].replace(/Number:/g,""),o=parseFloat(r[1]);return n&&!isNaN(o)&&l(l({},e),{},s({},n,o))||l({},e)}),l({message:c},u))||l({message:c},u);return l(l({},e),{},{loading:!1,canEdit:!(t.error&&(401===t.error.status||403===t.error.status||t.error.message&&-1!==t.error.message.indexOf("could not be unmarshalled"))),error:l(l({},e.error),{},s({},t.status||"global",l({status:t.error&&t.error.status||404},p)))});case n.dk:return l(l({},e),{},{metadata:l(l({},e.metadata),t.metadata)});default:return e}}},7654:(e,t,r)=>{var n=r(81763);e.exports=function(e){return n(e)&&e!=+e}}}]);