(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[4064],{7472:(e,t,n)=>{"use strict";n.d(t,{Z:()=>j});var r=n(27418),o=n.n(r),a=n(45697),l=n.n(a),i=n(24852),s=n.n(i),c=n(85294),d=n.n(c),u=n(72986),f=n.n(u),p=n(5346);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function O(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return E(e)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(i,e);var t,n,r,a,l=(r=i,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(r);if(a){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return O(this,e)});function i(){var e;y(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return N(E(e=l.call.apply(l,[this].concat(n))),"renderLoading",(function(){return e.props.maskLoading?s().createElement("div",{style:{width:"100%",height:"100%",position:"absolute",overflow:"visible",margin:"auto",verticalAlign:"center",left:"0",background:"rgba(255, 255, 255, 0.5)",zIndex:2}},s().createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -40%)"}},s().createElement(p.Z,{msgId:"loading"}),s().createElement(f(),{spinnerName:"circle",noFadeIn:!0,overrideSpinnerClassName:"spinner"}))):null})),N(E(e),"renderRole",(function(t){return s().Children.toArray(e.props.children).filter((function(e){return e.props.role===t}))})),N(E(e),"hasRole",(function(t){return s().Children.toArray(e.props.children).filter((function(e){return e.props.role===t})).length>0})),N(E(e),"onClickOut",(function(t){e.props.onClickOut&&e.mask===t.target&&e.props.onClickOut(t)})),e}return t=i,(n=[{key:"render",value:function(){var e=this,t=s().createElement("div",{id:this.props.id,style:g({zIndex:3},this.props.style),className:"".concat(this.props.draggable?"modal-dialog-draggable":""," ").concat(this.props.className," modal-dialog-container")},s().createElement("div",{className:this.props.headerClassName+" draggable-header"},this.renderRole("header")),s().createElement("div",{className:this.props.bodyClassName},this.renderLoading(),this.renderRole("body")),this.hasRole("footer")?s().createElement("div",{className:this.props.footerClassName},this.renderRole("footer")):s().createElement("span",null)),n=this.props.draggable?s().createElement(d(),{defaultPosition:this.props.start,bounds:this.props.bounds,handle:".draggable-header, .draggable-header *"},t):t,r=o()({},this.props.style.display?{display:this.props.style.display}:{},this.props.backgroundStyle);return this.props.modal?s().createElement("div",{ref:function(t){e.mask=t},onClick:this.onClickOut,style:r,className:"fade in modal "+this.props.containerClassName,role:"dialog"},n):n}}])&&h(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(s().Component);N(C,"propTypes",{id:l().string.isRequired,style:l().object,backgroundStyle:l().object,className:l().string,maskLoading:l().bool,containerClassName:l().string,headerClassName:l().string,bodyClassName:l().string,footerClassName:l().string,onClickOut:l().func,modal:l().bool,start:l().object,draggable:l().bool,bounds:l().oneOfType([l().string,l().object])}),N(C,"defaultProps",{style:{},backgroundStyle:{background:"rgba(0,0,0,.5)"},start:{x:0,y:150},className:"modal-dialog modal-content",maskLoading:!1,containerClassName:"",headerClassName:"modal-header",bodyClassName:"modal-body",footerClassName:"modal-footer",modal:!1,draggable:!0,bounds:"parent"});const j=C},75480:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(24852),o=n.n(r);const a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.style,n=void 0===t?{display:"inline-block"}:t;return o().createElement("div",{style:n,className:"mapstore-inline-loader"})}},94745:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var r=n(24852),o=n.n(r),a=n(30294),l=n(7472),i=n(80717),s=n(67076),c=n(19081),d=n.n(c),u=n(75480),f={xs:" ms-xs",sm:" ms-sm",md:"",lg:" ms-lg"},p={className:{vertical:" ms-fullscreen-v",horizontal:" ms-fullscreen-h",full:" ms-fullscreen"},glyph:{expanded:{vertical:"resize-vertical",horizontal:"resize-horizontal",full:"resize-small"},collapsed:{vertical:"resize-vertical",horizontal:"resize-horizontal",full:"resize-full"}}};const m=(0,s.withState)("fullscreenState","onFullscreen",(function(e){var t=e.initialFullscreenState;return void 0===t?"collapsed":t}))((function(e){var t=e.show,n=void 0!==t&&t,r=e.loading,s=e.loadingText,c=e.onClose,m=void 0===c?function(){}:c,b=e.title,g=void 0===b?"":b,y=e.clickOutEnabled,h=void 0===y||y,v=e.showClose,O=void 0===v||v,E=e.disabledClose,w=void 0!==E&&E,N=e.showFullscreen,C=void 0!==N&&N,j=e.fullscreenType,P=void 0===j?"full":j,T=e.buttons,k=void 0===T?[]:T,_=e.size,A=void 0===_?"":_,D=e.bodyClassName,S=void 0===D?"":D,x=e.children,z=e.draggable,R=void 0!==z&&z,M=e.fullscreenState,I=e.onFullscreen,G=e.fade,F=void 0!==G&&G,Z=e.fitContent,H=e.modalClassName,L=void 0===H?"":H,B=e.dialogClassName,X=void 0===B?"":B,q=e.enableFooter,Y=void 0===q||q,J=f[A]||"",K=C&&"expanded"===M&&p.className[P]||"",Q=n?o().createElement("div",{className:"modal-fixed ".concat(L," ")+(R?"ms-draggable":"")},o().createElement(l.Z,{id:"ms-resizable-modal",style:{display:"flex"},onClickOut:h?m:function(){},containerClassName:"ms-resizable-modal",draggable:R,modal:!0,className:"modal-dialog modal-content"+J+K+X+(Z?" ms-fit-content":"")},o().createElement("span",{role:"header"},o().createElement("h4",{className:"modal-title"},o().createElement("div",{className:"ms-title"},g),C&&p.className[P]&&o().createElement(a.Glyphicon,{className:"ms-header-btn",onClick:function(){return I("expanded"===M?"collapsed":"expanded")},glyph:p.glyph[M][P]}),O&&m&&o().createElement(a.Glyphicon,{glyph:"1-close",className:"ms-header-btn",onClick:m,disabled:w}))),o().createElement("div",{role:"body",className:S},x),Y&&o().createElement("div",{style:{display:"flex"},role:"footer"},o().createElement("div",{className:"ms-resizable-modal-loading-spinner-container"},r?o().createElement(u.Z,null):null),o().createElement("div",{className:"ms-resizable-modal-loading-text"},r?s:null),o().createElement(i.Z,{buttons:k})))):null;return F?o().createElement(d(),{transitionName:"ms-resizable-modal-fade",transitionEnterTimeout:300,transitionLeaveTimeout:300},Q):Q}))},84364:(e,t,n)=>{"use strict";n.r(t),n.d(t,{getMetadataBySlugName:()=>w,gnmetadataresource:()=>N,gnGetMetadata:()=>C,default:()=>T});var r=n(24852),o=n.n(r),a=n(9669),l=n.n(a),i=n(45697),s=n.n(i),c=n(49977),d=n(22843),u=n(30294),f=n(82904),p=n(22222),m=n(74621),b=n(827),g=n(71703),y=n(94745),h=n(32425);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(){var e=window.location.href;e.includes("/maps/")&&(e=e.replace("/view","").replace("/edit",""));var t="".concat(e.replace("#",""),"/metadata_detail/article");return l().get(t).then((function(e){return e.data}))};function N(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_GEONODE_METADATA":return O(O({},e),{},{loading:!0});case"SET_GEONODE_METADATA":return{error:null,data:t.data,loading:!1};case"GEONODE_METADATA_ERROR":return{data:null,error:t.error,loading:!1};default:return e}}var C=function(e,t){return e.ofType("FETCH_GEONODE_METADATA").switchMap((function(e){return c.Observable.defer((function(){return w()})).switchMap((function(e){return c.Observable.of(function(e){return{type:"SET_GEONODE_METADATA",data:e}}(e))})).catch((function(e){return c.Observable.of(function(e){return{type:"GEONODE_METADATA_ERROR",error:e}}(e.data||e.message))}))}))};function j(e){var t=e.resourceId,n=e.enabled,a=e.loading,l=e.error,i=e.data,s=e.onClose,c=e.onInit,d=(0,r.useRef)();return d.current={resourceId:t,data:i},(0,r.useEffect)((function(){n&&!i&&c(d.current.resourceId)}),[n]),o().createElement(y.Z,{modalClassName:"gn-metadata-modal",title:"Map Metadata",show:n,size:"lg",fitContent:!0,enableFooter:!1,clickOutEnabled:!1,onClose:function(){return s()}},o().createElement("div",{style:{top:0,left:0,minHeight:550,maxHeight:550,width:"100%",height:"100%",backgroundColor:"rgba(255, 255, 255, 0.8)",zIndex:2,display:"flex",alignItems:"center",justifyContent:"center"}},l&&o().createElement(u.Alert,{bsStyle:"danger",style:{margin:0}},o().createElement("div",null,"Metadata cannot be fetched")),i&&o().createElement("div",{style:{overflowY:"scroll",height:550,width:"100%",paddingLeft:20,paddingRight:20},dangerouslySetInnerHTML:{__html:i}}),a&&o().createElement(h.Z,{size:80})))}j.propTypes={resourceId:s().oneOfType([s().number,s().string]),enabled:s().bool,loading:s().bool,error:s().obj,data:s().string,onClose:s().func,onInit:s().func},j.defaultProps={resourceId:null,enabled:!1,loading:!1,error:null,data:"",onClose:function(){},onInit:function(){}};var P=(0,g.connect)((0,p.P1)([function(e){var t,n;return null==e||null===(t=e.controls)||void 0===t||null===(n=t.metadata)||void 0===n?void 0:n.enabled},b._H,function(e){var t;return null==e||null===(t=e.gnmetadataresource)||void 0===t?void 0:t.data},function(e){var t;return null==e||null===(t=e.gnmetadataresource)||void 0===t?void 0:t.loading},function(e){var t;return null==e||null===(t=e.gnmetadataresource)||void 0===t?void 0:t.error}],(function(e,t,n,r,o){return{enabled:e,resourceId:null==t?void 0:t.id,data:n,loading:r,error:o}})),{onClose:f.Xi.bind(null,"metadata",null),onInit:function(e){return{type:"FETCH_GEONODE_METADATA",id:e}}})(j);const T=(0,d.rx)("GeonodeMetadata",{component:P,containers:{BurgerMenu:{name:"geonode-metadata",position:30,text:"Map Metadata",icon:o().createElement(u.Glyphicon,{glyph:"list-alt"}),action:f.Xi.bind(null,"metadata",null),selector:(0,p.P1)(m.jl,b._H,(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t.canEdit,t.id);return{style:window.location.href.includes("/view/")||window.location.href.includes("/maps/")&&n?{}:{display:"none"}}}))}},epics:{gnGetMetadata:C},reducers:{gnmetadataresource:N}})},19081:(e,t,n)=>{"use strict";e.exports=n(1174)}}]);